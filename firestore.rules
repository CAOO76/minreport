rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // Las solicitudes solo pueden ser leídas por administradores.
    // La escritura es manejada por los servicios de backend.
    match /requests/{requestId} {
      allow get, list: if request.auth.token.admin == true;
      allow write: if false;

      // El historial de una solicitud también es solo para administradores.
      match /history/{logId} {
        allow get, list: if request.auth.token.admin == true;
        allow write: if false;
      }
    }

    // Las cuentas solo pueden ser leídas por administradores.
    // La escritura es manejada por los servicios de backend.
    match /accounts/{accountId} {
      allow get, list: if request.auth.token.admin == true;
      allow write: if false;

      // El historial de una cuenta también es solo para administradores.
      match /history/{logId} {
        allow get, list: if request.auth.token.admin == true;
        allow write: if false;
      }
    }
  }
}
